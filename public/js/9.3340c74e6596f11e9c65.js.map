{"version":3,"file":"js/9.3340c74e6596f11e9c65.js","sources":["webpack:///js/9.3340c74e6596f11e9c65.js"],"sourcesContent":["webpackJsonp([9],{AvVv:function(e,t,a){var i=a(\"X4fF\");\"string\"==typeof i&&(i=[[e.i,i,\"\"]]),i.locals&&(e.exports=i.locals);a(\"rjj0\")(\"27e4855f\",i,!0,{})},PXcA:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=a(\"Xxa5\"),n=a.n(i),s=a(\"NYxO\"),r=a(\"mtWM\"),o=a.n(r),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.default={middleware:[\"auth\",\"organisation\"],props:{id:{type:[Number,String],required:!0}},data:function(){return{disabled:!0,date:null,menu:!1,modal:!1,name:\"\",valid:!0,defaultItem:{},nameRules:[function(e){return!!e||\"Введите значение\"},function(e){return e&&e.length>1||\"Имя должно содержать минимум 2 буквы\"}],emailRules:[function(e){return!!e||\"Введите E-mail\"},function(e){return/^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/.test(e)||\"Не валидный E-mail\"}]}},computed:l({},Object(s.mapGetters)({items:\"employees/employees\",positions:\"positions/positions\",user:\"auth/user\"}),{item:function(){var e=this;return this.items.find(function(t){return t.id===+e.id})||{}},buttonText:function(){return this.disabled?\"Изменить данные\":\"Обновить\"},avatar:function(){return this.item.avatar?this.item.avatar:\"/storage/avatars/no-avatar.jpg\"}}),beforeRouteEnter:function(e,t,a){a(function(e){return e.$store.dispatch(\"employees/loadOne\",e.id)})},methods:l({},Object(s.mapActions)({changeItem:\"employees/edit\",updateUser:\"auth/updateUser\"}),{userUpdate:function(){var e=Object.assign({},this.user);e.name=this.item.first_name,this.updateUser(e)},buttonAction:function(){this.disabled||(this.changeItem(this.item),this.item.user_id==this.user.id&&this.userUpdate()),this.defaultItem=Object.assign({},this.item),this.disabled=!this.disabled},back:function(){if(this.disabled)return this.$router.go(-1);for(var e in this.item)this.item[e]=this.defaultItem[e];this.disabled=!this.disabled},uploadPhoto:function(){var e,t=(e=n.a.mark(function e(t){var a,i,s,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=document.getElementById(\"avatar-file\").files[0]){e.next=3;break}return e.abrupt(\"return\");case 3:return e.prev=3,(i=new FormData).append(\"image\",a),e.next=8,o.a.post(\"/api/employees/\"+this.id+\"/avatar\",i,{headers:{\"Content-Type\":\"multipart/form-data\"}});case 8:s=e.sent,r=s.data,this.item.avatar=r,this.$store.commit(\"employees/edit\",this.item),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(\"Не загрузился аватар\",e.t0);case 17:case\"end\":return e.stop()}},e,this,[[3,14]])}),function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(n,s){try{var r=t[n](s),o=r.value}catch(e){return void a(e)}if(!r.done)return Promise.resolve(o).then(function(e){i(\"next\",e)},function(e){i(\"throw\",e)});e(o)}(\"next\")})});return function(e){return t.apply(this,arguments)}}()})}},X4fF:function(e,t,a){(e.exports=a(\"FZ+f\")(!1)).push([e.i,\"[data-v-2f71677b]{-webkit-box-sizing:border-box;box-sizing:border-box;font-family:Roboto,sans-serif}h2[data-v-2f71677b]{-ms-flex-preferred-size:100%;flex-basis:100%;text-align:center}.avatar__overlay[data-v-2f71677b],.employee[data-v-2f71677b],p[data-v-2f71677b]{display:-moz-flex;display:-ms-flex;display:-o-flex;display:-webkit-box;display:-ms-flexbox;display:flex}p[data-v-2f71677b]{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin:0;padding:10px;-webkit-transition:background-color .3s;transition:background-color .3s}p[data-v-2f71677b]:hover{background-color:hsla(0,0%,100%,.1)}\",\"\"])},fJLR:function(e,t,a){var i=a(\"VU/8\")(a(\"PXcA\"),a(\"nkuh\"),!1,function(e){a(\"AvVv\")},\"data-v-2f71677b\",null);e.exports=i.exports},nkuh:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"employee\"},[a(\"h2\",[e._v(e._s(e.$t(\"employee\")))]),e._v(\" \"),a(\"div\",{staticClass:\"employee__avatar\"},[a(\"div\",{staticClass:\"employee__avatar-container\"},[a(\"div\",{staticClass:\"avatar__overlay\"},[a(\"upload-button\",{attrs:{title:e.$t(\"change_image\"),selectedCallback:e.uploadPhoto}})],1),e._v(\" \"),a(\"img\",{attrs:{src:e.avatar,alt:e.item.first_name}})])]),e._v(\" \"),a(\"div\",{staticClass:\"employee__descr\"},[a(\"v-form\",{ref:\"form\",attrs:{\"lazy-validation\":\"\"},model:{value:e.valid,callback:function(t){e.valid=t},expression:\"valid\"}},[a(\"v-text-field\",{attrs:{label:e.$t(\"name\"),counter:70,required:\"\",disabled:e.disabled},model:{value:e.item.first_name,callback:function(t){e.$set(e.item,\"first_name\",t)},expression:\"item.first_name\"}}),e._v(\" \"),a(\"v-text-field\",{attrs:{label:e.$t(\"last_name\"),rules:e.nameRules,counter:70,required:\"\",disabled:e.disabled},model:{value:e.item.last_name,callback:function(t){e.$set(e.item,\"last_name\",t)},expression:\"item.last_name\"}}),e._v(\" \"),a(\"v-text-field\",{attrs:{label:e.$t(\"patronymic\"),rules:e.nameRules,counter:70,disabled:e.disabled},model:{value:e.item.patronymic,callback:function(t){e.$set(e.item,\"patronymic\",t)},expression:\"item.patronymic\"}}),e._v(\" \"),a(\"v-select\",{attrs:{label:e.$t(\"position\"),\"prepend-icon\":\"card_travel\",items:e.positions,\"item-text\":\"title\",\"item-value\":\"id\",rules:[function(e){return!!e||\"Выберите должность\"}],required:\"\",disabled:e.disabled},model:{value:e.item.position_id,callback:function(t){e.$set(e.item,\"position_id\",t)},expression:\"item.position_id\"}}),e._v(\" \"),a(\"v-text-field\",{attrs:{label:e.$t(\"phone_number\"),\"prepend-icon\":\"phone_iphone\",required:\"\",disabled:e.disabled},model:{value:e.item.phone_number,callback:function(t){e.$set(e.item,\"phone_number\",t)},expression:\"item.phone_number\"}}),e._v(\" \"),a(\"v-text-field\",{attrs:{label:e.$t(\"salary\"),\"prepend-icon\":\"attach_money\",required:\"\",disabled:e.disabled},model:{value:e.item.salary,callback:function(t){e.$set(e.item,\"salary\",t)},expression:\"item.salary\"}}),e._v(\" \"),a(\"v-text-field\",{attrs:{label:e.$t(\"address\"),\"prepend-icon\":\"home\",required:\"\",disabled:e.disabled},model:{value:e.item.address,callback:function(t){e.$set(e.item,\"address\",t)},expression:\"item.address\"}}),e._v(\" \"),a(\"v-layout\",{attrs:{row:\"\",wrap:\"\"}},[a(\"v-flex\",{attrs:{xs12:\"\"}},[a(\"v-menu\",{ref:\"menu\",attrs:{lazy:\"\",\"close-on-content-click\":!1,transition:\"scale-transition\",\"offset-y\":\"\",\"full-width\":\"\",\"nudge-right\":40,\"min-width\":\"290px\",\"return-value\":e.date},on:{\"update:returnValue\":function(t){e.date=t}},model:{value:e.menu,callback:function(t){e.menu=t},expression:\"menu\"}})],1)],1),e._v(\" \"),a(\"div\",{staticClass:\"buttons\"},[a(\"v-btn\",{attrs:{large:\"\",disabled:!e.valid},on:{click:function(t){e.buttonAction()}}},[e._v(\"\\n\\t\\t\\t\\t\\t\\t\"+e._s(e.buttonText)+\"\\n\\t\\t\\t\\t\\t\\t\")]),e._v(\" \"),a(\"v-btn\",{attrs:{large:\"\"},on:{click:e.back}},[e._v(\"\\n\\t\\t\\t\\t\\t\\tНазад\\n\\t\\t\\t\\t\\t\\t\")])],1)],1)],1)])},staticRenderFns:[]}}});\n\n\n// WEBPACK FOOTER //\n// js/9.3340c74e6596f11e9c65.js"],"mappings":"AAAA","sourceRoot":""}