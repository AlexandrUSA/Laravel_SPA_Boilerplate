webpackJsonp([6],{"/io7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("NYxO"),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t};e.default={middleware:["auth","organisation"],props:{searchProp:{type:String,default:""}},data:function(){return{search:"",dialog:!1,deleteAlert:!1,deleteDenied:!1,headers:[{text:"Номер",align:"right",sortable:!1,value:"id"},{text:"Наименование",align:"right",value:"title"},{text:"Подразделение",align:"right",value:"department"},{text:"Сотрудников",align:"right",value:"employees"},{text:"Действия",align:"right",value:"title",sortable:!1}],editedIndex:-1,editedItem:{id:"",title:"",department_id:""},defaultItem:{id:"",title:"",department_id:""}}},computed:s({items:function(){var t=this,e=[];return this.positions.forEach(function(i){e.push({id:i.id,title:i.title,last_name:i.last_name,department:t.getDepartmentName(i.department_id),employees:t.getPositionEmployees(i.id).length})}),e}},Object(a.mapGetters)({positions:"positions/positions",departments:"departments/departments",employees:"employees/employees"}),{deleteMsg:function(){return this.deleteDenied?" За данной должностью закреплены сотрудники. Пожалуйста, распределите их на другие должности прежде чем удалять текущую.":" Вы действительно хотите удалить данную должность?"},formTitle:function(){return-1===this.editedIndex?"Новая должность":"Изменить должность"}}),watch:{dialog:function(t){t||this.close()}},methods:s({},Object(a.mapActions)({add:"positions/add",update:"positions/edit",remove:"positions/remove"}),{getDepartmentName:function(t){return this.departments.find(function(e){return e.id==t}).title},getPositionEmployees:function(t){return this.employees.filter(function(e){return e.position_id==t})},editItem:function(t){this.editedIndex=this.items.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem:function(t){this.deleteAlert=!0,this.getPositionEmployees(t.id).length?this.deleteDenied=!0:(this.deleteDenied=!1,this.editedIndex=t.id)},deleteConfirm:function(){this.remove(this.editedIndex),this.deleteAlert=!1,this.editedIndex=-1},close:function(){var t=this;this.dialog=!1,setTimeout(function(){t.editedItem=Object.assign({},t.defaultItem),t.editedIndex=-1},300)},save:function(){this.editedIndex>-1?this.update(this.editedItem):this.add(this.editedItem),this.close()}}),created:function(){this.searchProp&&(this.search=this.searchProp)}}},"9D4g":function(t,e,i){var a=i("VU/8")(i("/io7"),i("jC+T"),!1,function(t){i("Qkyz")},"data-v-77c2d04e",null);t.exports=a.exports},Qkyz:function(t,e,i){var a=i("qfdU");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("06b42a6c",a,!0,{})},"jC+T":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"positions"}},[i("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.deleteAlert,callback:function(e){t.deleteAlert=e},expression:"deleteAlert"}},[i("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[t._v("Добавить должность")]),t._v(" "),i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v("Внимание!")])]),t._v(" "),i("v-card-text",[t._v("\n        "+t._s(t.deleteMsg)+"\n      ")]),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteAlert=!t.deleteAlert}}},[t._v("Отмена")]),t._v(" "),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.deleteDenied,expression:"!deleteDenied"}],attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteConfirm(e)}}},[t._v("Удалить")])],1)],1)],1),t._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[t._v("Добавить должность")]),t._v(" "),i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v(t._s(t.formTitle))])]),t._v(" "),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("v-text-field",{attrs:{label:"Наименование"},model:{value:t.editedItem.title,callback:function(e){t.$set(t.editedItem,"title",e)},expression:"editedItem.title"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("v-select",{attrs:{label:t.$t("department"),"prepend-icon":"card_travel",items:t.departments,"item-text":"title","item-value":"id",rules:[function(t){return!!t||"Выберите подразделение"}],required:""},model:{value:t.editedItem.department_id,callback:function(e){t.$set(t.editedItem,"department_id",e)},expression:"editedItem.department_id"}})],1)],1)],1)],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.close(e)}}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.save(e)}}},[t._v("Save")])],1)],1)],1),t._v(" "),i("v-card",[i("v-card-title",{staticClass:"t-head"},[i("h2",[t._v(t._s(t.$t("positions")))]),t._v(" "),i("v-spacer"),t._v(" "),i("v-text-field",{attrs:{"append-icon":"search",label:t.$t("search_input"),"single-line":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,search:t.search,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.id))]),t._v(" "),i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.title))]),t._v(" "),i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.department))]),t._v(" "),i("td",{staticClass:"text-xs-right"},[i("router-link",{attrs:{tag:"span",to:{name:"employees",params:{searchProp:e.item.title}}}},[t._v("\n            "+t._s(e.item.employees)+"\n          ")])],1),t._v(" "),i("td",{staticClass:"text-xs-right"},[i("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(i){t.editItem(e.item)}}},[i("v-icon",{attrs:{color:"teal"}},[t._v("edit")])],1),t._v(" "),i("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(i){t.deleteItem(e.item)}}},[i("v-icon",{attrs:{color:"pink"}},[t._v("delete")])],1)],1)]}}])},[i("template",{slot:"no-data"},[i("v-btn",{attrs:{color:"primary"},on:{click:function(t){}}},[t._v("Обновить")])],1)],2)],1)],1)},staticRenderFns:[]}},qfdU:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"#positions[data-v-77c2d04e]{position:relative;max-width:90%;margin:10px auto}.mb-2.btn[data-v-77c2d04e]{position:absolute;bottom:-50px}.card__title.t-head[data-v-77c2d04e]{padding:0 15px}span[data-v-77c2d04e]{cursor:pointer}",""])}});
//# sourceMappingURL=6.223c150c9a399d68414d.js.map